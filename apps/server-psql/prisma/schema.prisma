generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Enquiry {
  id          String   @id @default(uuid())
  name        String
  email       String
  contactNum  String
  date        DateTime
  type        String
  description String
  followUp    Boolean  @default(false)
  followUpBy  Staff?   @relation(fields: [staffId], references: [id])
  staffId     String
}

model Staff {
  id               String    @id @default(uuid())
  name             String
  email            String    @unique
  password         String
  contactNum       String    @unique
  isAdmin          Boolean
  enquiriesHandled Enquiry[] // One staff can take care of zero or many Enquiries
  projects         Project[] // One staff can be in charge of zero or many Projects
}

model Contact {
  id         String  @id @default(uuid())
  name       String
  contactNum String  @unique
  client     Client? @relation(fields: [clientId], references: [id]) // Might or might not be related to a Client
  clientId   String?
  vendor     Vendor? @relation(fields: [vendorId], references: [id])
  vendorId   String?
}

model Client {
  id        String    @id @default(uuid())
  name      String
  email     String    @unique
  password  String    @unique
  isCompany Boolean   @default(false)
  contacts  Contact[] // Contains zero or many contacts associated with this Client
  projects  Project[] // Client can be part of zero or many Projects
}

model Vendor {
  id        String    @id @default(uuid())
  name      String
  email     String    @unique
  password  String    @unique
  employees Contact[] // Each Vendor can have many Employees
  projects  Project[] // Each Vendor can be involed in many Projects
}

model Project {
  id          String       @id @default(uuid())
  title       String
  type        String
  date        DateTime
  location    String
  budget      Int
  inCharge    Staff        @relation(fields: [inChargeId], references: [id]) // A Project can only have one Staff in charge
  inChargeId  String
  client      Client       @relation(fields: [clientId], references: [id]) // A Project can only have one Client
  clientId    String
  checkpoints Checkpoint[] // A Project can have zero or many Checkpoints
  vendors     Vendor[] // Each Project can have many Vendors
  notes       Note[] // Each Project can have many Notes
}

model Checkpoint {
  id          String   @id @default(uuid())
  description String
  date        DateTime
  project     Project  @relation(fields: [projectId], references: [id]) // Each Checkpoint is only for one Project
  projectId   String
}

model Note {
  id        String   @id @default(uuid())
  date      DateTime
  content   String[]
  project   Project  @relation(fields: [projectId], references: [id]) // Each Note is only for one Project
  projectId String
}